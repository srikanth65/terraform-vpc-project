name: Workflow Status Check

on:
  workflow_dispatch:

jobs:
  status-check:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Check Active Workflows
      run: |
        echo "‚úÖ Active workflows:"
        ls -la .github/workflows/
        echo ""
        echo "üîç Checking for SARIF references..."
        if grep -r "sarif\|codeql" .github/workflows/ --exclude="*-old.yml" || true; then
          echo "‚ö†Ô∏è  Found SARIF references in active workflows"
        else
          echo "‚úÖ No SARIF references in active workflows"
        fi
        echo ""
        echo "üîç Checking for secrets syntax..."
        if grep -r "if:.*secrets\." .github/workflows/ --exclude="*-old.yml" || true; then
          echo "‚ö†Ô∏è  Found potential secrets syntax issues"
        else
          echo "‚úÖ No secrets syntax issues found"
        fi

    - name: Test Slack Notification
      env:
        SLACK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
      run: |
        if [ -n "$SLACK_URL" ]; then
          curl -X POST -H 'Content-type: application/json' \
            --data '{"text":"‚úÖ Workflow status check completed - All systems operational!"}' \
            "$SLACK_URL"
          echo "‚úÖ Slack notification sent"
        else
          echo "‚ÑπÔ∏è  SLACK_WEBHOOK_URL not configured"
        fi
